<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Public Dashboard | Xbribe</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="/images/Xbribe_logo.png" type="image/x-icon">
    
    <link href="https://fonts.googleapis.com/css?family=Montserrat:200,300,400,500,600,700,800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
 
    <link rel="stylesheet" href="/css/animate.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" type="text/css" href="/css/table-public.css">
  </head>
  <body>

    <!-- loader -->
    <div id="xbribe-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px"><circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/><circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#F96D00"/></svg></div>


		<nav class="navbar navbar-expand-lg navbar-dark xbribe_navbar bg-dark xbribe-navbar-light" id="xbribe-navbar">
	    <div class="container">
	    	<a class="navbar-brand" href="/public">Public Portal</a>
	      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#xbribe-nav" aria-controls="xbribe-nav" aria-expanded="false" aria-label="Toggle navigation">
	        <span class="fa fa-bars"></span> Menu
	      </button>
	      <div class="collapse navbar-collapse" id="xbribe-nav">
	        <ul class="navbar-nav ml-auto">
            <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
	          <!-- <li class="nav-item"><a class="nav-link" href="/ministry">Ministry Login</a></li> -->
	          <li class="nav-item"><a class="nav-link" href="/admin">Admin Login</a></li>
	          <li class="nav-item"><a class="nav-link" href="#" data-toggle="modal" data-target="#filterModal">Filter Posts</a></li>
	        </ul>
	      </div>
	    </div>
	  </nav>
    <!-- END nav -->

    <!-- filter Modal -->
    <div class="modal fade" id="filterModal">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
        
          <!-- Modal Header -->
          <div class="modal-header">
            <h4 class="modal-title">Select filters</h4>
            <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
          
          <!-- Modal body -->
          <div class="modal-body">
            <form id="filterForm" method="get">

              <div class="form-group">
                <label for="ministryId"><b>Ministry</b></label>
                <select name="ministryId" class="custom-select">
                  <option value="any">Any Ministry</option>
                  <% if (ministries) { Object.keys(ministries).forEach((key) => { %>
                    <option class="w3-input w3-border" value="<%= key %>"><%= ministries[key] %></option>
                  <% })} %>
                </select>
              </div>

              <div class="row">
                <div class="col-sm-6">
                  <div class="form-group">
                    <label for="from"><b>Date (From):</b></label>
                    <input class="form-control" name="from" type="date">
                  </div>
                </div>
                <div class="col-sm-6">
                  <div class="form-group">
                    <label for="to"><b>Date (To):</b></label>
                    <input class="form-control" name="to" type="date">
                  </div>
                </div>
              </div>

              <div class="form-group">
                <label for="resolved"><b>Case Status</b></label>
                <select name="status" class="custom-select">
                  <option value="any">Any</option>
                  <option value="submitted">Received</option>
                  <option value="accepted">Accepted</option>
                  <option value="archived">Archived</option>
                  <option value="resolved">Resolved</option>
                </select>
              </div>

              <div class="row">
                <div class="col-sm-6">
                  <div class="form-group">
                    <label for="orderBy"><b>Order By</b></label>
                    <select name="orderBy" class="custom-select">
                      <option value="new">Newest first</option>
                      <option value="old">Oldest first</option>
                    </select>
                  </div>
                </div>
                <div class="col-sm-6">
                  <div class="form-group">
                    <label for="size"><b>Posts per page</b></label>
                    <select name="size" class="custom-select">
                      <option value="20">20</option>
                      <option value="30">30</option>
                      <option value="50">50</option>
                      <option value="100">100</option>
                    </select>
                  </div>
                </div>
              </div>

              <input name="query" type="text" value="" hidden>
              
              <button type="submit" class="btn btn-primary btn-block">Apply Filter</button>
            </form>
          </div>
          
        </div>
      </div>
    </div>


    <section class="hero-wrap hero-wrap-22 bg-dark" style="background-image: url('/images/bg_1.jpg');" data-stellar-background-ratio="0.5">
      <div class="overlay"></div>
      <div class="container">
        <div class="row no-gutters slider-text align-items-end">
          <div class="col-md-9 xbribe-animate pb-4 pt-4">
            <h1 class="mb-0 breadd text-dark pt-5 mt-5">Xbribe</h1>
          </div>
        </div>
      </div>
    </section>


		<section class="xbribe-section bg-light xbribe-faqs">
    	<div class="container">

				<div class="heading-section xbribe-animate row mb-3 mt-0 pt-0">
          <div class="col-md-6">
            <h2 class="mb-2">Recently Registered Complaints</h2>
					  <p>Below are some newly registered complaints arranged in tabular form</p>
          </div>
          <div class="col-md-6">
            <div class="sidebar-box">
              <form class="search-form" method="GET" action="/public">
                <div class="form-group mb-0">
                  <span class="fa fa-search"></span>
                  <input type="text" name="query" class="form-control" placeholder="Type a keyword and hit enter">
                </div>
              </form>
            </div>
          </div>
				</div>

        <% if (error) { %>
          <div class="alert alert-danger xbribe-animate mb-0"><strong><%= message %></strong></div>
        <% }else {%>
  
          <div id="posts">
  
            <div class="alert alert-success alert-dismissible fade show xbribe-animate mb-0">
              <button type="button" class="close" data-dismiss="alert">&times;</button>
              <%= message %>
            </div>


            <div class="container-table100 xbribe-animate">
              <div class="wrap-table100">
                <div class="table">
    
                  <div class="row table-row header">
                    <div class="cell"> Sr No </div>
                    <div class="cell"> Department </div>
                    <div class="cell"> Date </div>
                    <div class="cell"> Place </div>
                  </div>
                  
                  <!-- loop over all cases and render them -->
                  <% var n = (pageNo===1) ? 1 : ((pageNo-1)*pageSize+1)  %>
                  <% if (posts && ministries) { posts.forEach((post) => { %>
        
                    <div class="row table-row">
                      <div class="cell" data-title="Serial No.">
                        <%= n %>
                      </div>
                      <div class="cell" data-title="Department">
                        <%= post.department || 'Not Specified' %>
                      </div>
                      <div class="cell" data-title="Date">
                        <%= post.date.toLocaleString() %>
                      </div>
                      <div class="cell" data-title="Place">
                        <%= post.place %>
                      </div>
                    </div>
                    <% n=n+1 %>

                  <% })} else { %>
                    <div class="alert alert-danger mb-2">There was some error</div>
                  <% } %>
    
                </div>
              </div>
            </div>
            
          </div>
        <% } %>

        <%- include('../partials/pagination') %>

        <div class="heading-section my-5">
					<h2 class="mb-5 xbribe-animate">Graphical Trends</h2>
					<div class="w-100 xbribe-animate">
						<canvas id="myChart"></canvas>
					</div>
        </div>

    	</div>
    </section>


    <footer class="footer xbribe-animate">
			<div class="container">
        <p class="copyright text-center mb-0">
          Copyright &copy; <script>document.write(new Date().getFullYear());</script> All rights reserved | Xbribe
        </p>
			</div>
		</footer>    
  

  <script src="js/jquery-3.2.1.min.js"></script>
  <script src="/js/jquery-migrate-3.0.1.min.js"></script>
  <!-- <script src="/js/popper.min.js"></script> -->
  <script src="/js/bootstrap.min.js"></script>
  <!-- <script src="/js/jquery.easing.1.3.js"></script> -->
  <script src="/js/jquery.waypoints.min.js"></script>
  <script src="/js/jquery.stellar.min.js"></script>
  <script src="/js/jquery.animateNumber.min.js"></script>
  <!-- <script src="/js/bootstrap-datepicker.js"></script> -->
  <!-- <script src="/js/jquery.timepicker.min.js"></script> -->
  <script src="/js/owl.carousel.min.js"></script>
  <script src="/js/jquery.magnific-popup.min.js"></script>
  <!-- <script src="/js/scrollax.min.js"></script> -->
  <script src="/scripts/jquery-filter.js"></script>
  <script src="/js/Chart.bundle.min.js"></script>
  <script src="/scripts/draw-public-chart.js"></script>
  <script src="/js/main.js"></script>

    
  </body>
</html>